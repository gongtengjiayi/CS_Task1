# UDP 客户端 - 服务器通信系统

## 概述
本项目实现了一个基于 UDP 协议的客户端 - 服务器通信系统，模拟了 TCP 协议中的连接建立、数据传输和连接关闭过程，同时支持数据包的超时重传和丢包处理。客户端从 `input.txt` 文件中读取数据并将其分割成固定大小的数据包发送给服务器，服务器接收数据包并返回 ACK 确认信息。通信结束后，客户端会打印丢包率和 RTT（往返时间）统计信息。

## 代码文件说明
- `UDPClient.java`：UDP 客户端程序，负责读取文件、建立连接、发送数据、处理 ACK 确认和关闭连接。
- `UDPServer.java`：UDP 服务器程序，负责接收连接请求、处理数据包、发送 ACK 确认和关闭连接。

## 运行环境
- Java 开发环境（JDK 8 及以上）

## 运行步骤

### 服务器端
1. 编译 `UDPServer.java` 文件：
```bash
javac UDPServer.java
```
2. 运行编译后的程序：
```bash
java UDPServer
```
3. 程序会提示输入服务器端口号，输入一个有效的端口号（如 8888）并回车，服务器将开始监听该端口。

### 客户端
1. 编译 `UDPClient.java` 文件：
```bash
javac UDPClient.java
```
2. 运行编译后的程序：
```bash
java UDPClient
```
3. 程序会提示输入服务器的 IP 地址和端口号，输入服务器的 IP 地址和之前设置的端口号并回车。
4. 客户端将读取 `input.txt` 文件，并开始与服务器建立连接和发送数据。

## 代码功能说明

### UDPClient.java
- **连接建立**：使用三次握手协议（SYN、SYN - ACK、ACK）与服务器建立连接。
- **数据发送**：将 `input.txt` 文件内容分割成固定大小的数据包（70 字节数据 + 10 字节首部），使用滑动窗口机制进行发送，并处理超时重传。
- **ACK 处理**：接收服务器发送的 ACK 确认信息，更新滑动窗口和重传计数，并计算 RTT。
- **连接关闭**：使用四次挥手协议（FIN、ACK、FIN、ACK）与服务器关闭连接。
- **统计信息**：通信结束后，打印丢包率、最大 RTT、最小 RTT、平均 RTT 和 RTT 标准差。

### UDPServer.java
- **连接处理**：接收客户端的连接请求，使用三次握手协议建立连接。
- **数据处理**：接收客户端发送的数据包，模拟 5% 的丢包率，处理正常包、乱序包和重复包，并立即发送 ACK 确认。
- **连接关闭**：接收客户端的 FIN 包，使用四次挥手协议关闭连接，并设置超时检查，防止永远等不到最终 ACK。

## 注意事项
- 请确保 `input.txt` 文件存在于客户端程序的运行目录下，否则会抛出文件读取异常。
- 服务器和客户端需要在同一网络环境下，或者通过正确的 IP 地址和端口号进行通信。
- 代码中使用了多线程和并发数据结构，确保程序在高并发情况下的稳定性。

## 扩展建议
- 可以添加更多的错误处理和日志记录，提高程序的健壮性。
- 可以优化滑动窗口机制和超时重传策略，提高数据传输效率。
- 可以实现数据加密和验证机制，增强通信的安全性。
